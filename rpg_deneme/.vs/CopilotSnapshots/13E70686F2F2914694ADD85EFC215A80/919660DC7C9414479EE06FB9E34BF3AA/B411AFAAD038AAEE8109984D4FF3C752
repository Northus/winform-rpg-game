using System.Drawing;

namespace rpg_deneme.Models;

public class BattleEntity
{
    public float X { get; set; }

    public float Y { get; set; }

    public int Width { get; set; }

    public int Height { get; set; }

    public float Speed { get; set; }

    public int CurrentHP { get; set; }

    public int MaxHP { get; set; }

    public int CurrentMana { get; set; }
    public int MaxMana { get; set; }

    public string Name { get; set; }

    public int MinDamage { get; set; }
    public int MaxDamage { get; set; }

    public int Defense { get; set; }

    public float VX { get; set; }

    public float VY { get; set; }

    public int AIState { get; set; }

    public int DecisionCooldown { get; set; }

    public int StrafeSign { get; set; } = 1;

    // Cached bounds and center to avoid allocation every frame
    private Rectangle _cachedBounds;
    private Point _cachedCenter;
    private float _lastBoundsX = float.MinValue;
    private float _lastBoundsY = float.MinValue;

    public Rectangle Bounds
    {
        get
        {
            // Only recalculate if position changed
            if (_lastBoundsX != X || _lastBoundsY != Y)
            {
                _cachedBounds = new Rectangle((int)X, (int)Y, Width, Height);
                _lastBoundsX = X;
                _lastBoundsY = Y;
            }
            return _cachedBounds;
        }
    }

    public Point Center
    {
        get
        {
            // Only recalculate if position changed
            if (_lastBoundsX != X || _lastBoundsY != Y)
            {
                _cachedCenter = new Point((int)(X + Width / 2f), (int)(Y + Height / 2f));
            }
            return _cachedCenter;
        }
    }

    public bool IsRanged { get; set; } = false;

    public int AttackRange { get; set; } = 50;

    // Animation Properties
    public float AnimTimer { get; set; }
    public bool IsMoving { get; set; }
    public bool FacingRight { get; set; } = true;
    public float VisualAttackTimer { get; set; } // 0 = no attack, >0 = swinging

    // Per-entity attack cooldown
    public int AttackCooldown { get; set; }
}
